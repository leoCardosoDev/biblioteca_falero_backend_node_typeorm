PASS tests/main/routes/create-user-login-routes.test.ts
PASS tests/infra/db/typeorm/neighborhood-repository.spec.ts
PASS tests/main/routes/add-user-login-routes.test.ts
PASS tests/main/routes/user-routes.test.ts
PASS tests/presentation/controllers/user/update-user-controller.spec.ts
PASS tests/infra/db/typeorm/user-repository.spec.ts
  â— Console

    console.error
      [DATA CORRUPTION] Failed to reconstitute User 2114b05d-3f0f-496d-ad3a-f85c11d0cf66: Invalid email format

      77 |     } catch (error) {
      78 |       const errorMessage = error instanceof Error ? error.message : String(error)
    > 79 |       console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: ${errorMessage}`)
         |               ^
      80 |       return null
      81 |     }
      82 |   }

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:79:15)
      at toUserModel (src/infra/db/typeorm/user-repository.ts:125:35)
          at Array.map (<anonymous>)
      at UserTypeOrmRepository.map [as loadAll] (src/infra/db/typeorm/user-repository.ts:125:18)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:295:19)

    console.error
      [DATA CORRUPTION] Failed to reconstitute User ece95631-5554-4df6-96f5-35dda00f6f22: Invalid Name - "A"

      25 |       const nameOrError = Name.create(entity.name)
      26 |       if (!(nameOrError instanceof Name)) {
    > 27 |         console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: Invalid Name - "${entity.name}"`)
         |                 ^
      28 |         return null
      29 |       }
      30 |

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:27:17)
      at toUserModel (src/infra/db/typeorm/user-repository.ts:125:35)
          at Array.map (<anonymous>)
      at UserTypeOrmRepository.map [as loadAll] (src/infra/db/typeorm/user-repository.ts:125:18)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:316:19)

    console.error
      [DATA CORRUPTION] Failed to reconstitute User 634ee074-daab-42f5-b982-20c11281a30b: Invalid RG - ""

      32 |       const rgOrError = Rg.create(entity.rg)
      33 |       if (!(rgOrError instanceof Rg)) {
    > 34 |         console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: Invalid RG - "${entity.rg}"`)
         |                 ^
      35 |         return null
      36 |       }
      37 |

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:34:17)
      at toUserModel (src/infra/db/typeorm/user-repository.ts:125:35)
          at Array.map (<anonymous>)
      at UserTypeOrmRepository.map [as loadAll] (src/infra/db/typeorm/user-repository.ts:125:18)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:336:19)

    console.error
      [DATA CORRUPTION] Failed to reconstitute User c79c5577-8c63-472b-a049-bce9ec63ce47: Invalid BirthDate - "not-a-valid-date"

      39 |       const birthDateOrError = BirthDate.create(entity.birthDate)
      40 |       if (!(birthDateOrError instanceof BirthDate)) {
    > 41 |         console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: Invalid BirthDate - "${entity.birthDate}"`)
         |                 ^
      42 |         return null
      43 |       }
      44 |

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:41:17)
      at toUserModel (src/infra/db/typeorm/user-repository.ts:125:35)
          at Array.map (<anonymous>)
      at UserTypeOrmRepository.map [as loadAll] (src/infra/db/typeorm/user-repository.ts:125:18)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:356:19)

    console.error
      [DATA CORRUPTION] Failed to reconstitute User a217096a-eb4f-4193-9ed8-5e3d7cd770ac: Invalid RG - ""

      32 |       const rgOrError = Rg.create(entity.rg)
      33 |       if (!(rgOrError instanceof Rg)) {
    > 34 |         console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: Invalid RG - "${entity.rg}"`)
         |                 ^
      35 |         return null
      36 |       }
      37 |

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:34:17)
      at UserTypeOrmRepository.toUserModel (src/infra/db/typeorm/user-repository.ts:112:17)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:374:18)

    console.error
      [DATA CORRUPTION] Failed to reconstitute User ca414a27-892f-4259-a59b-226dd26d8f68: Invalid Name - "A"

      25 |       const nameOrError = Name.create(entity.name)
      26 |       if (!(nameOrError instanceof Name)) {
    > 27 |         console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: Invalid Name - "${entity.name}"`)
         |                 ^
      28 |         return null
      29 |       }
      30 |

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:27:17)
      at UserTypeOrmRepository.toUserModel [as loadByCpf] (src/infra/db/typeorm/user-repository.ts:119:17)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:391:18)

    console.error
      [DATA CORRUPTION] Failed to reconstitute User c22f3eb8-039a-4f28-be4a-c611143e1609: string-error-not-Error-instance

      77 |     } catch (error) {
      78 |       const errorMessage = error instanceof Error ? error.message : String(error)
    > 79 |       console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: ${errorMessage}`)
         |               ^
      80 |       return null
      81 |     }
      82 |   }

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:79:15)
      at toUserModel (src/infra/db/typeorm/user-repository.ts:125:35)
          at Array.map (<anonymous>)
      at UserTypeOrmRepository.map [as loadAll] (src/infra/db/typeorm/user-repository.ts:125:18)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:440:19)

    console.error
      [DATA CORRUPTION] Failed to reconstitute User 550e8400-e29b-41d4-a716-446655440001: Invalid Name - "A"

      25 |       const nameOrError = Name.create(entity.name)
      26 |       if (!(nameOrError instanceof Name)) {
    > 27 |         console.error(`[DATA CORRUPTION] Failed to reconstitute User ${entity.id}: Invalid Name - "${entity.name}"`)
         |                 ^
      28 |         return null
      29 |       }
      30 |

      at UserTypeOrmRepository.error [as toUserModel] (src/infra/db/typeorm/user-repository.ts:27:17)
      at UserTypeOrmRepository.toUserModel [as loadById] (src/infra/db/typeorm/user-repository.ts:132:17)
      at Object.<anonymous> (tests/infra/db/typeorm/user-repository.spec.ts:479:20)

PASS src/infra/db/typeorm/session-repository.spec.ts
PASS tests/infra/db/typeorm/login-repository.spec.ts
PASS tests/infra/db/typeorm/entities/user-entity.spec.ts
PASS tests/infra/db/typeorm/typeorm-helper.spec.ts
PASS src/presentation/controllers/add-neighborhood-controller.spec.ts
PASS tests/presentation/controllers/add-user-controller.spec.ts
PASS tests/application/usecases/db-load-user-by-id.spec.ts
PASS tests/presentation/controllers/create-user-login-controller.spec.ts
PASS tests/presentation/controllers/user/add-user-login-controller.spec.ts
PASS tests/presentation/controllers/user/load-user-by-id-controller.spec.ts
PASS tests/application/usecases/db-add-user-login.spec.ts
PASS tests/application/usecases/db-refresh-token.spec.ts
PASS tests/presentation/controllers/user/delete-user-controller.spec.ts
PASS tests/presentation/helpers/http-helper.spec.ts
PASS tests/presentation/controllers/user/load-users-controller.spec.ts
PASS tests/application/usecases/db-load-users.spec.ts
PASS tests/presentation/controllers/refresh-token-controller.spec.ts
PASS tests/infra/cryptography/bcrypt-adapter.spec.ts
PASS tests/application/usecases/db-authentication.spec.ts
PASS src/presentation/middlewares/auth-middleware.spec.ts
PASS tests/presentation/controllers/login-controller.spec.ts
PASS tests/application/usecases/db-add-user.spec.ts
PASS src/presentation/controllers/login/login-controller.spec.ts
PASS tests/domain/value-objects/email.spec.ts
PASS src/infra/cryptography/jwt-adapter.spec.ts
PASS tests/domain/value-objects/expiration-date.spec.ts
PASS tests/application/usecases/db-update-user.spec.ts
PASS tests/application/usecases/db-create-user-login.spec.ts
PASS src/presentation/middlewares/require-role-middleware.spec.ts
PASS tests/main/factories/add-user-validation-factory.spec.ts
PASS tests/domain/value-objects/user-status.spec.ts
PASS tests/domain/value-objects/cpf.spec.ts
PASS src/infra/cryptography/sha256-adapter.spec.ts
PASS src/application/usecases/db-add-neighborhood.spec.ts
PASS tests/application/usecases/db-delete-user.spec.ts
PASS tests/validation/validators/validation-composite.spec.ts
PASS tests/domain/value-objects/rg.spec.ts
PASS tests/domain/value-objects/user-role.spec.ts
PASS tests/domain/value-objects/id.spec.ts
PASS tests/validation/validators/required-field-validation.spec.ts
PASS tests/domain/value-objects/password.spec.ts
PASS tests/domain/value-objects/address.spec.ts
PASS tests/domain/value-objects/birth-date.spec.ts
PASS tests/main/factories/create-user-login-validation-factory.spec.ts
PASS tests/domain/value-objects/name.spec.ts
----------------------------------|---------|----------|---------|---------|-------------------
File                              | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
----------------------------------|---------|----------|---------|---------|-------------------
All files                         |     100 |      100 |     100 |     100 |                   
 application/usecases             |     100 |      100 |     100 |     100 |                   
  db-add-neighborhood.ts          |     100 |      100 |     100 |     100 |                   
  db-add-user-login.ts            |     100 |      100 |     100 |     100 |                   
  db-add-user.ts                  |     100 |      100 |     100 |     100 |                   
  db-authentication.ts            |     100 |      100 |     100 |     100 |                   
  db-create-user-login.ts         |     100 |      100 |     100 |     100 |                   
  db-delete-user.ts               |     100 |      100 |     100 |     100 |                   
  db-load-user-by-id.ts           |     100 |      100 |     100 |     100 |                   
  db-load-users.ts                |     100 |      100 |     100 |     100 |                   
  db-refresh-token.ts             |     100 |      100 |     100 |     100 |                   
  db-update-user.ts               |     100 |      100 |     100 |     100 |                   
 domain/errors                    |     100 |      100 |     100 |     100 |                   
  cpf-in-use-error.ts             |     100 |      100 |     100 |     100 |                   
  domain-error.ts                 |     100 |      100 |     100 |     100 |                   
  email-in-use-error.ts           |     100 |      100 |     100 |     100 |                   
  invalid-address-error.ts        |     100 |      100 |     100 |     100 |                   
  invalid-birth-date-error.ts     |     100 |      100 |     100 |     100 |                   
  invalid-cpf-error.ts            |     100 |      100 |     100 |     100 |                   
  invalid-email-error.ts          |     100 |      100 |     100 |     100 |                   
  invalid-id-error.ts             |     100 |      100 |     100 |     100 |                   
  invalid-name-error.ts           |     100 |      100 |     100 |     100 |                   
  invalid-password-error.ts       |     100 |      100 |     100 |     100 |                   
  invalid-rg-error.ts             |     100 |      100 |     100 |     100 |                   
  invalid-user-role-error.ts      |     100 |      100 |     100 |     100 |                   
  invalid-user-status-error.ts    |     100 |      100 |     100 |     100 |                   
  not-found-error.ts              |     100 |      100 |     100 |     100 |                   
 domain/models                    |     100 |      100 |     100 |     100 |                   
  role.ts                         |     100 |      100 |     100 |     100 |                   
 domain/value-objects             |     100 |      100 |     100 |     100 |                   
  address.ts                      |     100 |      100 |     100 |     100 |                   
  birth-date.ts                   |     100 |      100 |     100 |     100 |                   
  cpf.ts                          |     100 |      100 |     100 |     100 |                   
  email.ts                        |     100 |      100 |     100 |     100 |                   
  expiration-date.ts              |     100 |      100 |     100 |     100 |                   
  id.ts                           |     100 |      100 |     100 |     100 |                   
  name.ts                         |     100 |      100 |     100 |     100 |                   
  password.ts                     |     100 |      100 |     100 |     100 |                   
  rg.ts                           |     100 |      100 |     100 |     100 |                   
  user-role.ts                    |     100 |      100 |     100 |     100 |                   
  user-status.ts                  |     100 |      100 |     100 |     100 |                   
 infra/cryptography               |     100 |      100 |     100 |     100 |                   
  bcrypt-adapter.ts               |     100 |      100 |     100 |     100 |                   
  jwt-adapter.ts                  |     100 |      100 |     100 |     100 |                   
  sha256-adapter.ts               |     100 |      100 |     100 |     100 |                   
 infra/db/typeorm                 |     100 |      100 |     100 |     100 |                   
  login-repository.ts             |     100 |      100 |     100 |     100 |                   
  neighborhood-repository.ts      |     100 |      100 |     100 |     100 |                   
  session-repository.ts           |     100 |      100 |     100 |     100 |                   
  user-repository.ts              |     100 |      100 |     100 |     100 |                   
 presentation/controllers         |     100 |      100 |     100 |     100 |                   
  add-neighborhood-controller.ts  |     100 |      100 |     100 |     100 |                   
  add-user-controller.ts          |     100 |      100 |     100 |     100 |                   
  create-user-login-controller.ts |     100 |      100 |     100 |     100 |                   
 presentation/controllers/login   |     100 |      100 |     100 |     100 |                   
  login-controller.ts             |     100 |      100 |     100 |     100 |                   
  refresh-token-controller.ts     |     100 |      100 |     100 |     100 |                   
 presentation/controllers/user    |     100 |      100 |     100 |     100 |                   
  add-user-login-controller.ts    |     100 |      100 |     100 |     100 |                   
  delete-user-controller.ts       |     100 |      100 |     100 |     100 |                   
  load-user-by-id-controller.ts   |     100 |      100 |     100 |     100 |                   
  load-users-controller.ts        |     100 |      100 |     100 |     100 |                   
  update-user-controller.ts       |     100 |      100 |     100 |     100 |                   
 presentation/errors              |     100 |      100 |     100 |     100 |                   
  access-denied-error.ts          |     100 |      100 |     100 |     100 |                   
  app-error.ts                    |     100 |      100 |     100 |     100 |                   
  missing-param-error.ts          |     100 |      100 |     100 |     100 |                   
  server-error.ts                 |     100 |      100 |     100 |     100 |                   
  unauthorized-error.ts           |     100 |      100 |     100 |     100 |                   
 presentation/helpers             |     100 |      100 |     100 |     100 |                   
  http-helper.ts                  |     100 |      100 |     100 |     100 |                   
 presentation/middlewares         |     100 |      100 |     100 |     100 |                   
  auth-middleware.ts              |     100 |      100 |     100 |     100 |                   
  require-role-middleware.ts      |     100 |      100 |     100 |     100 |                   
 validation/validators            |     100 |      100 |     100 |     100 |                   
  required-field-validation.ts    |     100 |      100 |     100 |     100 |                   
  validation-composite.ts         |     100 |      100 |     100 |     100 |                   
----------------------------------|---------|----------|---------|---------|-------------------

Test Suites: 51 passed, 51 total
Tests:       337 passed, 337 total
Snapshots:   0 total
Time:        9.457 s
Ran all test suites.
